<div [ngClass]="{nightbg: isNight, daybg: !isNight}">

  <ng-template #runSheriffOrNot>
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">è­¦é•¿ç«é€‰</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="sendReady()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        ä½ è¦ç«é€‰è­¦é•¿å—ï¼Ÿ
      </div>
      <div class="modal-footer">
        <button id="roleready" type="button" class="btn btn-success" (click)="sendVote(user.name)">è¦!</button>
        <button type="button" class="btn btn-secondary" (click)="sendReady()">ä¸è¦</button>
      </div>
    </div>
  </ng-template>

  <ng-template #passBadgeOrNot>
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">è­¦å¾½</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="sendReady()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        ä½ è¦ä¼ é€’è­¦å¾½å—ï¼Ÿ
        <div>
          <button type="button" class="btn btn-outline-primary m-3" *ngFor="let user of game.users"
            (click)="sendVote(user.name)">
            {{user.name}}
          </button>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="sendReady()">ä¸è¦</button>
      </div>
    </div>
  </ng-template>


  <ng-template #userRole>
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">ä½ çš„èº«ä»½</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="sendStart()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        {{user.name}}çš„èº«ä»½æ˜¯<strong class="text-danger">{{sio.roleLabel[user.role]}}</strong>!
      </div>
      <div class="modal-footer">
        <button id="roleready" type="button" class="btn btn-success" (click)="sendStart()">è®°ä½å•¦ï¼Œå¼€å§‹å§</button>
      </div>
    </div>
  </ng-template>

  <ng-template #saveOrNot>
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">è§£è¯</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="sendReady()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        {{user.lastAttacked}} è¢«å’¬äº†ï¼Œæ•‘å—ï¼Ÿ
      </div>
      <div class="modal-footer">
        <button id="roleready" type="button" class="btn btn-success" (click)="sendVote(user.lastAttacked)">æ•‘</button>
        <button type="button" class="btn btn-secondary" (click)="sendReady()">ä¸æ•‘</button>
      </div>
    </div>
  </ng-template>

  <ng-template #poisonOrNot>
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">æ¯’è¯</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="sendReady()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        è¦æ¯’è°å—ï¼Ÿ
        <div>
          <button type="button" class="btn btn-outline-primary m-3" *ngFor="let user of game.users"
            (click)="sendVote(user.name)">
            {{user.name}}
          </button>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="sendReady()">ä¸æ¯’</button>
      </div>
    </div>
  </ng-template>

  <div *ngIf="game">
    <div class="text-center">
      <span>Day {{game.round}}</span>
    </div>

    <div *ngIf="user">
      <button type="button" id="myrole" class="btn btn-info" (click)="openModal('userRole')">æˆ‘çš„èº«ä»½</button>
      <span *ngIf="user.alive">ğŸ˜€</span>
      <span *ngIf="!user.alive">ğŸ˜µ</span>
      <span *ngIf="user.sheriff">ğŸš”</span>
      <button type="button" id="restart" class="btn btn-warning" (click)="restartGame()">Restart</button>
      <!--debug-->
      <button type="button" id="test1" class="btn btn-outline-info" (click)="openModal('saveOrNot')">save</button>
      <button type="button" id="test2" class="btn btn-outline-info" (click)="openModal('poisonOrNot')">poison</button>
      <button type="button" id="test3" class="btn btn-outline-info" (click)="openModal('runSheriffOrNot')">run</button>
      <div> {{user.name}} {{currentRound}} {{currentState}} {{user.role}} </div>
    </div>

    <div *ngIf="this.currentState == 'roleCheck' && !this.sio.gameStatus.readySent">
      è¯·æ£€æŸ¥ä½ çš„èº«ä»½
    </div>
    <div *ngIf="this.currentState !== 'roleCheck' || this.sio.gameStatus.readySent" class="row m-3">
      <div class="col-6 p-1" *ngFor="let user of game.users" (click)="sendVote(user.name)">
        <div class="card shadow"
          [ngClass]="{'text-white': isNight, 'bg-dark': isNight, 'text-dark': !isNight, 'bg-light': !isNight}">
          <div class="row no-gutters">
            <div class="col-4">
              <img *ngIf="user.alive" src="/assets/person.svg" class="card-img">
              <img *ngIf="!user.alive" src="/assets/deadperson.svg" class="card-img">
            </div>
            <div class="col-8">
              <div class="card-body">
                <img>
                {{user.name}}
                <span *ngIf="user.isOrganizer">ğŸš¦</span>
                <span *ngIf="user.sheriffRunning">âœ‹</span>
                <span *ngIf="user.sheriff">ğŸš”</span>
                <span *ngIf="!user.alive">ğŸ˜µ</span>
                <span *ngIf="user.selected">âœ…</span>
                <!-- <button type="button" class="btn btn-outline-primary" (click)="sendVote(user.name)">Select</button> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="messages.length" class="notification-footer">
      <div *ngFor="let message of messages" class="alert alert-info">{{message}}</div>
    </div>

  </div>

</div>